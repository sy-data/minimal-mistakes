var vURL="http://olap.tmoncorp.com/cascade/db2.jsp";function getXMLHttpRequest(){if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e1){return null}}}else if(window.XMLHttpRequest){return new XMLHttpRequest()}else{return null}}function sendValueRequest(a,b,c){httpRequest=getXMLHttpRequest();httpMethod=c?c:'GET';if(httpMethod!='GET'&&httpMethod!='POST'){httpMethod='GET'}httpParams=(a==null||a=='')?null:a;httpUrl=vURL;if(httpMethod=='GET'&&httpParams!=null){httpUrl=httpUrl+"?"+httpParams}httpRequest.open(httpMethod,httpUrl);httpRequest.setRequestHeader('Content-Type','application/x-www-form-urlencoded');httpRequest.onreadystatechange=function(){if(this.readyState==4){if(this.status==200){if(b){setSelectObj(b,this.responseXML)}}else{alert("Error")}}}httpRequest.send(httpMethod=='POST'?httpParams:null)}function clearSelectObj(a){var b=a while(b.childNodes.length>2){b.removeChild(b.childNodes[2])}}function setSelectObj(a,b){clearSelectObj(a);var c=null;var d=a._fM.c?a._fM.c[0].c[0]["@useValue"]:'';for(var i=0;i<b.getElementsByTagName("code").length;i++){var f=b.getElementsByTagName("cd")[i].firstChild.nodeValue;var g=b.getElementsByTagName("cdnm")[i].firstChild.nodeValue;c=document.createElement("option");c.value=f;c.dv=g;if(f==d){c.selected=true}c.appendChild(document.createTextNode(g));a.appendChild(c)}try{a.onchange()}catch(e){}}function getcombos(){var a={},dept2={},dept3={},dept4={};var b=(typeof getFormWarpRequest=="function"?getFormWarpRequest():document.forms["formWarpRequest"]);try{a=b._oLstChoicesdept1}catch(e){console.log(e);return}try{dept2=b._oLstChoicesdept2}catch(e){console.log(e);return}try{dept3=b._oLstChoicesdept3}catch(e){console.log(e);return}try{dept4=b._oLstChoicesdept4}catch(e){console.log(e);return}a.onchange=function(){sendValueRequest("sqlType=Lv3"+"&objValue="+this.options[this.selectedIndex].value,dept2,"POST")};dept2.onchange=function(){sendValueRequest("sqlType=Lv4"+"&objValue="+this.options[this.selectedIndex].value,dept3,"POST")};dept3.onchange=function(){let svr=sendValueRequest("sqlType=Lv5"+"&objValue="+this.options[this.selectedIndex].value,dept4,"POST")};sendValueRequest("sqlType=Lv2"+"&objValue=",a,"POST")}
